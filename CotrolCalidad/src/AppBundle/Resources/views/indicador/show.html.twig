{% extends 'base.html.twig' %}
{% block referencia %}
     <ol class="breadcrumb">
        <li><a href="{{ path('proceso_show',{'id':indicador.proceso.id})}}">Proceso</a></li>
        <li>Indicador</li>
      </ol>
{% endblock %}
{% block body %}
    <div class="col-md-4">
          <!-- About Me Box -->
          <div class="box box-primary">
            <div class="box-header with-border">
              <h3 class="box-title">{{ indicador.nombre }}</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
               <table class="table table-striped">
                <tbody>
                    <tr>
                        <th>Codigo</th>
                        <td>
                            {% if indicador.codigo < 10 %}
                                0{{ indicador.codigo }}
                                {% else %}
                                {{ indicador.codigo }}   
                            {% endif %}
                        </td>
                        <th>Nombre</th>
                        <td>{{ indicador.nombre }}</td>
                    </tr>
                    <tr>
                        <th>Tipo</th>
                        <td>{{ indicador.tipo }}</td>
                        <th>Tablero</th>
                        <td>{{ indicador.tablero }}</td>
                    </tr>
                    
                    <tr>
                        <th>Unidad de medida</th>
                        <td>{{ indicador.unidadMedida }}</td>
                         <th>Periodicidad</th>
                        <td>{{ indicador.periodicidad }}</td>
                    </tr>
                    <tr>
                        <th>Meta</th>
                        <td>{{ indicador.meta }}</td>
                        <th>Rango</th>
                        <td>
                            {% if indicador.rango != null %}
                                {% for nivel in indicador.rango.niveles %}
                                   <b> {{nivel.nombre}}:</b> {{nivel.valorMaximo}}%<br>
                                {% endfor %}
                                {% else %}

                            {% endif %}
                        </td>
                    </tr>
                    <tr>Rango para acciones de mejora: {{indicador.porcentajeAcciones}}</tr>
                </tbody>
            </table>
                   
            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->
</div>

<div class="col-lg-3">

                    <p> 
                        Objetivo:
                        <textarea class="form-control">{{ indicador.objetivo }}</textarea> 
                    </p>

                    <p>
                        Pertinencia:
                        <textarea class="form-control">{{ indicador.pertinencia }}</textarea> 
                    </p>
                     <p>
                        Metodologia:
                        <textarea class="form-control">{{ indicador.metodolgia }}</textarea> 
                    </p>

</div>



<div class="col-md-1">
<a  data-toggle="tooltip"data-original-title="Agregar Responsable" href="{{ path('indicadorcargo_new', { 'idIndicador': indicador.id }) }}" class="btn btn-app">
      <i class="fa fa-plus"></i> Responsable
    </a>
    <br>
<a  data-toggle="tooltip"data-original-title="Editar Indicador" href="{{ path('indicador_edit', { 'id': indicador.id }) }}" class="btn btn-app">
      <i class="fa fa-edit"></i> Editar
    </a>
    <br>

<a  data-toggle="tooltip"data-original-title="Agregar Variable" href="{{ path('variable_new', { 'idIndicador': indicador.id }) }}" class="btn btn-app">
  <i class="fa fa-plus"></i> Variable
</a>
<br>
</div>

<div class="col-md-4">
          <!-- About Me Box -->
          <div class="box box-primary">
            <div class="box-header with-border">
              <h3 class="box-title">Responzables</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Cargo</th>
                            <th>role Responsable</th>
                            <th>Eliminar</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for indicadorCargo in indicador.indicadoresCargos %}
                        <tr>
                            <td>{{indicadorCargo.cargo.nombre}}</td>
                            <td>{{indicadorCargo.roleResponsable}}</td>
                            <td>
                                 <a class="btn btn-danger btn-flat"  href="#" data-href="{{ path('indicadorcargo_delete', { 'id': indicadorCargo.id,'idIndicador':indicador.id }) }}" data-toggle="modal" data-target="#confirm-delete"><i class="fa fa-close"></i></a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>

            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->

          <!-- About Me Box -->
          <div class="box box-primary">
            <div class="box-header with-border">
              <h3 class="box-title">Variables</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for variable in indicador.variables %}
                        <tr>
                            <td>{{variable.nombre}}</td>
                            <td>
                                 <a class="btn btn-danger btn-flat"  href="#" data-href="{{ path('variable_delete', { 'id': variable.id,'idIndicador':indicador.id }) }}" data-toggle="modal" data-target="#confirm-delete"><i class="fa fa-close"></i></a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>

            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->

</div>


<div class="col-lg-12">
    <div class="col-lg-6">
          <!-- About Me Box -->
          <div class="box box-primary col-lg-3">
            <div class="box-header with-border">
              <h3 class="box-title">Seguimiento <small><a href="{{ path('seguimientoindicador_new', { 'idIndicador': indicador.id }) }}">Nuevo Seguimiento</a></small></h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
                <table class="table display">
                    <thead>
                        <tr>
                            <th>Fechaseguimiento</th>
                            <th>Proximafecha</th>
                            <th>Resultado</th>
                            <th><h5> <b>porcentaje</b> <small>resultado/meta</small></h5></th>
                            <th>Acciones</th>

                        </tr>
                    </thead>
                    <tbody>
                    {% for seguimientoIndicador in indicador.seguimientosIndicadores %}
                        <tr>
                            <td>{% if seguimientoIndicador.fechaSeguimiento %}{{ seguimientoIndicador.fechaSeguimiento|date('Y-m-d') }}{% endif %}</td>
                            <td>{% if seguimientoIndicador.proximaFecha %}{{ seguimientoIndicador.proximaFecha|date('Y-m-d') }}{% endif %}</td>
                            <td>{{ seguimientoIndicador.resultado }}</td>
                            <td>{{ seguimientoIndicador.porcentaje }}</td>
                            <td>
                                {% if seguimientoIndicador.porcentaje < indicador.porcentajeAcciones %} <a data-toggle="tooltip"data-original-title="Porcentaje bajo" href="{{ path('seguimientoindicador_show', { 'id': seguimientoIndicador.id }) }}" class="btn btn-danger btn-flat btn-xs" ><i class="fa  fa-warning"></i></a>{% endif %}
                               
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody> 
                </table>

            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->
          </div>
          <div class="col-lg-6">

            <div class="box box-primary">
            <div class="box-header with-border">
              <h3 class="box-title">Seguimiento -Indicador</h3>

              <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                </button>
                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
              </div>
            </div>
            <div class="box-body chart-responsive">
              <div class="chart" id="bar-chart" style="height: 300px;"></div>
            </div>
            <!-- /.box-body -->
          </div>


          </div>
</div>


<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
               Confirmacion!!
            </div>
            <div class="modal-body">
              Seguro desea eliminar 
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <a class="btn btn-danger btn-ok">Eliminar</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{parent()}}

             {#  {% for nivel in indicador.rango.niveles %}
                                   <b> {{nivel.nombre}}:</b> {{nivel.valorMaximo}}%<br>
              {% endfor %} #}
<script>

            
                
                
                var bar = new Morris.Bar({
                element: 'bar-chart',
                resize: true,
                data: [{
                {% for seguimientoIndicador in indicador.seguimientosIndicadores %}
                  y: '', a{{ seguimientoIndicador.id }}: {{ seguimientoIndicador.resultado }},
                {% endfor %}
                }
                ],

                barColors: [

                    {% for seguimientoIndicador in indicador.seguimientosIndicadores %}
                        {% for nivel in seguimientoIndicador.indicador.rango.niveles %}

                            {% if (seguimientoIndicador.resultado >= nivel.valorMinimo) and (seguimientoIndicador.resultado <= nivel.valorMaximo) %}

                            '{{nivel.color}}',

                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                ],
                xkey: 'y',
                ykeys: [
                    {% for seguimientoIndicador in indicador.seguimientosIndicadores %}
                      'a{{ seguimientoIndicador.id }}',
                    {% endfor %}
                    ,,,,,,,,,,
                    
                ],
                hideHover: 'auto'
              });



</script>


         
    
{% endblock %}

